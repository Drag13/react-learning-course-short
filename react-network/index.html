<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>React For Beginners - React and network</title><meta name="description" content="Free learning course - React: React and network"><meta name="keywords" content="react free learning course beginners"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="React For Beginners - React and network"><meta name="twitter:site" content="https://github.com/Drag13/react-learning-course-short/react-network"><meta name="twitter:creator" content="@drag137"><meta name="twitter:image" content="https://drag13.io/react-learning-course-short/shared/imgs/title.png"><meta property="og:image" content="https://drag13.io/react-learning-course-short/shared/imgs/title.png"><meta property="og:title" content="React For Beginners - React and network"><meta name="og:site_name" content="React For Beginners - React and network"><meta property="og:url" content="https://drag13.io/"><meta property="og:type" content="website"><meta name="application-name" content="React For Beginners - React and network"><meta name="author" content="drag13"><meta name="robots" content="index follow"><link rel="stylesheet" href="https://drag13.io/react-learning-course-short/0/index.1568b79b.css"><link rel="stylesheet" href="https://drag13.io/react-learning-course-short/0/index.698ea738.css"><link rel="stylesheet" href="https://drag13.io/react-learning-course-short/0/index.22ba7868.css"><link rel="stylesheet" href="https://drag13.io/react-learning-course-short/0/index.f84d4caf.css"></head><body> <div class="reveal"> <div class="slides"> <section> <h1 class="ukraine"> Free React Course <br> For Beginners </h1> </section> <section> <h1>L10 - React and network</h1> <h4> <u> React For Beginners by Itera </u> </h4> </section> <section> <section> <h2>Fetch</h2> </section> <section> <h3>In a nutshell working with network is easy</h3> </section> <section> <h3>Schema</h3> <ul> <li>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API"></a> fetch api to issue an network request</li> <li>Update state on success</li> <li>Handle error if any</li> </ul> </section> <section> <h3>Class based component example</h3> </section> <section> <h3>Define a class with an initial state</h3> <pre><code data-line-numbers="">class FreeApi extends PureComponent {
    state = { errored: false, apis: [] };
}
            </code></pre> </section> <section> <h3>On ComponentDidMount implement fetching</h3> <pre><code data-line-numbers="">async componentDidMount() {
    try {
        const rawData = await fetch(FREE_API_URL);
        const { entries } = await rawData.json();
        this.setState({ errored:false, apis: entries });
    } catch (e) {
        this.setState({ errored: true, apis: [] });
    }
}</code></pre> </section> <section> <h3>Render the result</h3> <pre><code data-line-numbers="">render() {
    const { apis, errored } = this.state;
    return errored ? (&lt;div&gt;Something went wrong&lt;/div&gt;) 
    : &lt;ul&gt;{apis.map(({ API, Link }) =&gt; (
            &lt;li key={Link}&gt;
            {API}::{Link}
            &lt;/li&gt;
        ))}
      &lt;/ul&gt;
    ;
}</code></pre> </section> <section> <h3>Don't forget to use <i>key</i> when rendering the list</h3> </section> <section> <h3>Full <a href="https://raw.githubusercontent.com/Drag13/react-learning-course-short/master/presentations/react-network/code/fetch-cb.tsx">example</a></h3> </section> <section> <h3>ALWAYS HANDLE ERRORS</h3> <p>Network - the most unreliable part of your app</p> </section> <section> <h3>Functional example</h3> </section> <section> <h3>Create custom hook with default state</h3> <pre><code data-line-numbers="">import { PureComponent, useEffect, useState } from "react";

const useFreeApi = () =&gt; {
  const [data, setApi] = useState({ errored: false, apis: [] });
  return data;
};
            </code></pre> </section> <section> <h3>Add useEffect hook with fetch inside</h3> <pre><code class="language-javascript" data-line-numbers="">useEffect(() =&gt; {
    async function updateApi() {
        try {
          const rawData = await fetch(FREE_API_URL);
            const { entries } = await rawData.json();
            setApi({ errored: false, apis: entries });
        } catch (error) {
            setApi({ errored: true, apis: [] });
        }
    }
    updateApi();
}, []);</code></pre> </section> <section> <h3>Pay attention to useEffect</h3> <p class="left">If you will call fetch directly - the request will be issued every re-render</p> </section> <section> <h3>Pay attention to useEffect</h3> <p class="left"> Don't forget to set an empty array of dependencies to fire useEffect only once </p> </section> <section> <h3>Use the new hook as usual</h3> <pre><code data-line-numbers="">const FreeApi = () =&gt; {
    const { errored, apis } = useFreeApi();
    return errored ? (&lt;div&gt;Something went wrong&lt;/div&gt;) : (
        &lt;ul&gt;
        {apis.map(({ API, Link }) =&gt; (
            &lt;li key={Link}&gt;
            {API}::{Link}
            &lt;/li&gt;
        ))}
        &lt;/ul&gt;
    );
};</code></pre> </section> <section> <h3>Full <a href="https://raw.githubusercontent.com/Drag13/react-learning-course-short/master/presentations/react-network/code/fetch-functional.tsx">example</a></h3> </section> <section> <h3>However, fetch has some pitfalls</h3> </section> <section> <h3>Internet Explorer</h3> <p class="left">Despite Internet Explorer being deprecated even by the author, it's still popular in a big companies</p> <p class="fade-up fragment left"><strong> Fetch doesn't work in IE </strong> </p> </section> <section> <h3>Canceling request</h3> <p class="left">Sometimes you will need to cancel a request</p> <p class="fade-up fragment left"><strong> Fetch doesn't cancel </strong> </p> <p class="fade-up fragment left">The work on canceling is ongoing</p> </section> <section> <h3>No progress tracking, no timeout</h3> <p class="left"> <strong> Little fetch is a bit limited </strong> </p> </section> </section> <section> <section> <h2>Axios</h2> </section> <section> <h3>Axios@0.26.1</h3> <ul> <li>‚≠ê 92_000 </li> <li class="fade-up fragment">Downloads: 28,198,607</li> <li class="fade-up fragment">Size: 16kB</li> </ul> </section> <section> <h3>Benefits</h3> <ul> <li>Works with IE üíî</li> <li class="fade-up fragment">Supports aborting request</li> <li class="fade-up fragment">Support progress</li> <li class="fade-up fragment">Support interceptors</li> </ul> </section> <section> <h3>Example</h3> <pre><code class="language-javascript" data-line-numbers="">const axios = Axios.create();
...
useEffect(() =&gt; {
    async function updateApi() {
        try {
            const { data } = await axios.get(FREE_API_URL);
            const { entries } = data;
            setApi({ errored: false, apis: entries });
        } catch (error) {
            setApi({ errored: true, apis: [] });
        }
    }
    updateApi();
}, []);
            </code></pre> </section> <section> <h3>Differences</h3> <ul> <li>Need to create an instance before using</li> <li class="fragment">Don't need to use <i>.toJson()</i> to get an object</li> </ul> </section> <section> <h3>Global config</h3> <pre><code data-line-numbers="">const axios = Axios.create({
    baseURL: 'https://some-domain.com/api/',
    timeout: 1000,
    headers: {'X-Custom-Header': 'foobar'}
});
        </code></pre> </section> <section> <h3>Why to use - Easy to cancel</h3> <pre><code data-line-numbers="">const abort = new AbortController();
useEffect(){
    try {
        const { data } = await axios.get(FREE_API_URL, {signal: abort.signal});
    }
    ...
    return ()=> abort.abort()
}

<p class="left">You can use AbortController or legacy CancelToken</p>
        </code></pre> </section> <section> <h3>Why to use - Interceptors</h3> <pre><code data-line-numbers="">const axios = Axios.create();
axios.interceptors.response.use((response) =&gt; {
    console.log(response.request.responseURL);
    return response;
});</code></pre> </section> <section> <h3>Full <a href="https://raw.githubusercontent.com/Drag13/react-learning-course-short/master/presentations/react-network/code/fetch-axios.tsx">example</a></h3> </section> </section> <section> <h2>Useful links</h2> <ul> <li><a target="_blank" rel="noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch</a></li> <li><a target="_blank" rel="noopener noreferrer" href="https://github.com/axios/axios">Axios</a></li> <li><a target="_blank" rel="noopener noreferrer" href="https://github.com/public-apis/public-apis">Public API</a></li> </ul> </section> </div> </div> <script src="https://drag13.io/react-learning-course-short/0/index.764e4403.js" type="module"></script> <footer class="footer"> <a href="https://itera.com"> <img src="https://drag13.io/react-learning-course-short/Itera-logo-white-fuchsia.b04eab97.jpg" alt="https://itera.com"> </a> </footer> </body></html>